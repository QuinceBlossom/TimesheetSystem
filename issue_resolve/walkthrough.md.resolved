# Admin Edit and Manager Assignment Feature

## Thay Ä‘á»•i Ä‘Ã£ thá»±c hiá»‡n

1. **CÆ¡ sá»Ÿ dá»¯ liá»‡u**:
   - ThÃªm cá»™t `manager_id` vÃ o báº£ng `users` Ä‘á»ƒ há»— trá»£ gÃ¡n nhÃ¢n viÃªn cho quáº£n lÃ½ tÆ°Æ¡ng á»©ng.

2. **Backend (API)**:
   - Cáº­p nháº­t API `POST /users/add` Ä‘á»ƒ cho phÃ©p truyá»n thÃªm `manager_id` khi táº¡o nhÃ¢n viÃªn má»›i.
   - Bá»• sung API `PUT /users/update/:id` cho phÃ©p cáº­p nháº­t thÃ´ng tin nhÃ¢n viÃªn, bao gá»“m viá»‡c quáº£n lÃ½ thay Ä‘á»•i máº­t kháº©u (náº¿u Ä‘á»ƒ trá»‘ng thÃ¬ giá»¯ nguyÃªn máº­t kháº©u cÅ©) vÃ  thay Ä‘á»•i `manager_id`.

3. **Frontend (Admin Dashboard)**:
   - ThÃªm cá»™t **NgÆ°á»i quáº£n lÃ½** vÃ o báº£ng danh sÃ¡ch ngÆ°á»i dÃ¹ng Ä‘á»ƒ hiá»ƒn thá»‹ rÃµ tÃªn cá»§a quáº£n lÃ½ Ä‘Æ°á»£c gÃ¡n cho nhÃ¢n viÃªn.
   - ThÃªm nÃºt hÃ nh Ä‘á»™ng **Sá»­a** bÃªn cáº¡nh nÃºt **XÃ³a** á»Ÿ cá»™t "HÃ nh Ä‘á»™ng".
   - TÃ¡i sá»­ dá»¥ng Modal nháº­p liá»‡u cÅ© thÃ nh Modal Ä‘a nÄƒng (ThÃªm má»›i & Sá»­a thÃ´ng tin), trong Ä‘Ã³ náº¿u lÃ  sá»­a thÃ¬ cÃ¡c trÆ°á»ng sáº½ Ä‘Æ°á»£c tá»± Ä‘á»™ng Ä‘iá»n thÃ´ng tin cÅ©.
   - ThÃªm trÆ°á»ng lá»±a chá»n **NgÆ°á»i quáº£n lÃ½** vÃ o cáº£ form ThÃªm vÃ  form Sá»­a, danh sÃ¡ch nÃ y tá»± Ä‘á»™ng lá»c nhá»¯ng user cÃ³ role lÃ  `manager` hoáº·c `admin`.

## HÆ°á»›ng dáº«n kiá»ƒm tra

Vui lÃ²ng cháº¡y láº¡i project (cáº£ Frontend vÃ  Backend) vÃ  kiá»ƒm tra theo cÃ¡c bÆ°á»›c sau:

1. ÄÄƒng nháº­p vÃ o há»‡ thá»‘ng báº±ng tÃ i khoáº£n `admin`.
2. Má»Ÿ sang trang **Quáº£n lÃ½ há»‡ thá»‘ng** (Admin Dashboard).
3. Kiá»ƒm tra xem trÃªn báº£ng nhÃ¢n viÃªn cÃ³ hiá»ƒn thá»‹ cá»™t "NgÆ°á»i quáº£n lÃ½" vÃ  nÃºt "Sá»­a" á»Ÿ pháº§n HÃ nh Ä‘á»™ng hay chÆ°a.
4. Nháº¥n nÃºt **Sá»­a** á»Ÿ má»™t nhÃ¢n viÃªn báº¥t ká»³:
   - ThÃ´ng tin cÅ© cá»§a nhÃ¢n viÃªn Ä‘Ã³ pháº£i tá»± Ä‘á»™ng Ä‘Æ°á»£c Ä‘iá»n lÃªn Form.
   - Chá»n má»™t **NgÆ°á»i quáº£n lÃ½** á»Ÿ má»¥c dropdown.
   - Nháº¥n **LÆ°u láº¡i** vÃ  Ä‘áº£m báº£o thÃ´ng tin nhÃ¢n viÃªn Ä‘Ã£ Ä‘Æ°á»£c thay Ä‘á»•i thÃ nh cÃ´ng, cÅ©ng nhÆ° báº£ng hiá»ƒn thá»‹ Ä‘Æ°á»£c cáº­p nháº­t láº¡i chÃ­nh xÃ¡c.
5. Thá»­ nháº¥n nÃºt **ThÃªm nhÃ¢n viÃªn má»›i**, báº¡n cÅ©ng sáº½ nhÃ¬n tháº¥y trÆ°á»ng chá»n "NgÆ°á»i quáº£n lÃ½" á»Ÿ Form thÃªm má»›i nhÆ° Ä‘Ã£ yÃªu cáº§u.

> [!NOTE]
> Máº­t kháº©u khi sá»­a náº¿u Ä‘Æ°á»£c bá» trá»‘ng, há»‡ thá»‘ng sáº½ tá»± Ä‘á»™ng giá»¯ nguyÃªn máº­t kháº©u cÅ© theo Ä‘Ãºng nghiá»‡p vá»¥ Ä‘á»ƒ trÃ¡nh lÃ m máº¥t máº­t kháº©u cá»§a ngÆ°á»i dÃ¹ng.

## PhÃ¢n quyá»n Dashboard Cáº¥p Quáº£n LÃ½

1. **Backend (API)**:
   - Cáº­p nháº­t API `GET /manager/stats` Ä‘á»ƒ nháº­n tham sá»‘ `managerId`. Náº¿u cÃ³ `managerId`, API sáº½ chá»‰ Ä‘áº¿m vÃ  tráº£ vá» danh sÃ¡ch cÃ¡c nhÃ¢n viÃªn cÃ³ `manager_id` tÆ°Æ¡ng á»©ng vá»›i ID cá»§a quáº£n lÃ½ Ä‘ang yÃªu cáº§u.

2. **Frontend (Manager Dashboard)**:
   - Cáº­p nháº­t trang [ManagerDashboard.jsx](file:///d:/DoAnTotNghiep/frontend/src/components/ManagerDashboard.jsx) Ä‘á»ƒ tá»± Ä‘á»™ng truyá»n `user.id` (cá»§a manager Ä‘ang Ä‘Äƒng nháº­p) vÃ o API.
   - Nhá» Ä‘Ã³, Quáº£n lÃ½ A sáº½ chá»‰ nhÃ¬n tháº¥y vÃ  Ä‘Æ°á»£c phÃ©p Duyá»‡t/Há»§y/Nháº­p há»™ cÃ´ng viá»‡c cho NhÃ¢n viÃªn A, B (náº¿u Ä‘Æ°á»£c Admin gÃ¡n). Quáº£n lÃ½ B sáº½ chá»‰ nhÃ¬n tháº¥y NhÃ¢n viÃªn C.

**CÃ¡ch kiá»ƒm thá»­:**
1. DÃ¹ng tÃ i khoáº£n Admin, gÃ¡n nhÃ¢n viÃªn A cho Manager 1.
2. ÄÄƒng xuáº¥t, Ä‘Äƒng nháº­p vÃ o tÃ i khoáº£n Manager 1.
3. á» trang chá»§ Dashboard cá»§a Manager 1, xÃ¡c nháº­n ráº±ng chá»‰ hiá»ƒn thá»‹ duy nháº¥t nhÃ¢n viÃªn A, khÃ´ng hiá»ƒn thá»‹ cÃ¡c nhÃ¢n viÃªn khÃ¡c.

## Quáº£n lÃ½ PhiÃªn (Session) & PhÃ¢n quyá»n Admin
1. **Kiá»ƒm tra tá»± tÃ¡c Ä‘á»™ng lÃªn báº£n thÃ¢n:**
   - Khi Ä‘Äƒng nháº­p báº±ng tÃ i khoáº£n Admin, báº¡n sáº½ KHÃ”NG tháº¥y nÃºt KhÃ³a/Má»Ÿ khÃ³a hay nÃºt XÃ³a á»Ÿ dÃ²ng danh sÃ¡ch cá»§a chÃ­nh báº¡n.
2. **Kiá»ƒm tra luá»“ng XÃ³a nhÃ¢n viÃªn:**
   - Äá»ƒ xÃ³a má»™t nhÃ¢n viÃªn, báº¡n báº¯t buá»™c pháº£i nháº¥n **KhÃ³a** trÆ°á»›c. NÃºt **XÃ³a** sáº½ chá»‰ xuáº¥t hiá»‡n khi tráº¡ng thÃ¡i cá»§a nhÃ¢n viÃªn Ä‘Ã³ lÃ  `Blocked`.
3. **Kiá»ƒm tra Force-Logout (cháº·n Ä‘Äƒng nháº­p khi thao tÃ¡c):**
   - ÄÄƒng nháº­p tÃ i khoáº£n NhÃ¢n viÃªn A trÃªn má»™t trÃ¬nh duyá»‡t (hoáº·c tab áº©n danh).
   - á» tab chÃ­nh (Admin), áº¥n **KhÃ³a** NhÃ¢n viÃªn A.
   - Quay láº¡i tab NhÃ¢n viÃªn A, thá»­ áº¥n lÆ°u cháº¥m cÃ´ng hoáº·c chuyá»ƒn tuáº§n. Há»‡ thá»‘ng láº­p tá»©c hiá»‡n lÃªn thÃ´ng bÃ¡o "PhiÃªn Ä‘Äƒng nháº­p khÃ´ng há»£p lá»‡!" vÃ  Ä‘Ã¡ vÄƒng nhÃ¢n viÃªn A ra ngoÃ i mÃ n hÃ¬nh ÄÄƒng nháº­p.
4. **Kiá»ƒm tra Ä‘Äƒng nháº­p bá»‹ khÃ³a:**
   - Sau khi NhÃ¢n viÃªn A Ä‘Ã£ bá»‹ khÃ³a, thá»­ Ä‘Äƒng nháº­p láº¡i vá»›i Ä‘Ãºng tÃ i khoáº£n máº­t kháº©u. Há»‡ thá»‘ng sáº½ bÃ¡o "TÃ i khoáº£n cá»§a báº¡n Ä‘Ã£ bá»‹ táº¡m khÃ³a...".
5. **Kiá»ƒm tra Báº£o vá»‡ Admin ChÃ­nh (Main Admin Rule):**
   - ÄÄƒng nháº­p báº±ng tÃ i khoáº£n "Admin ChÃ­nh" (ID = 1). Admin chÃ­nh cÃ³ thá»ƒ tháº¥y nÃºt KhÃ³a/Má»Ÿ khÃ³a vÃ  XÃ³a cá»§a cÃ¡c Admin phÃ³ khÃ¡c vÃ  thao tÃ¡c bÃ¬nh thÆ°á»ng.
   - ÄÄƒng nháº­p báº±ng tÃ i khoáº£n má»™t "Admin PhÃ³" (ID khÃ¡c 1). 
   - Admin phÃ³ sáº½ nhÃ¬n tháº¥y dÃ²ng cá»§a Admin chÃ­nh hiá»ƒn thá»‹ dÃ²ng chá»¯ `ğŸ”’ (Admin chÃ­nh)` thay vÃ¬ cÃ¡c nÃºt KhÃ³a/XÃ³a. Admin phÃ³ cÅ©ng khÃ´ng thá»ƒ KhÃ³a/XÃ³a Admin phÃ³ khÃ¡c qua API (Há»‡ thá»‘ng sáº½ bÃ¡o lá»—i).
